# E2E —Ç–µ—Å—Ç—ã –¥–ª—è Transport Online

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç end-to-end (e2e) —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Transport Online —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Playwright.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

- **app.spec.ts** - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **routes.spec.ts** - –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –º–∞—Ä—à—Ä—É—Ç–∞–º–∏ (–≤—ã–±–æ—Ä, –ø–æ–∏—Å–∫, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
- **map.spec.ts** - –¢–µ—Å—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–∞—Ä—Ç–æ–π –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- **stations.spec.ts** - –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –æ—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –∏ –∏—Ö –ø–æ–ø–∞–ø–∞–º–∏
- **vehicles.spec.ts** - –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –∏ –∏—Ö –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏
- **helpers.ts** - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **example-with-helpers.spec.ts** - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ö–µ–ª–ø–µ—Ä–æ–≤

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –î–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å Sidebar
Sidebar –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–∫—Ä—ã—Ç:

```typescript
const toggleBtn = page.locator('.sidebar-toggle-btn');
await toggleBtn.click();
await page.waitForTimeout(500);
```

### –®–∞–≥ 2: –†–∞—Å–∫—Ä—ã—Ç—å –ê–∫–∫–æ—Ä–¥–µ–æ–Ω
–ú–∞—Ä—à—Ä—É—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Bootstrap Accordion:

```typescript
const firstAccordion = page.locator('.accordion-button').first();
await firstAccordion.click();
await page.waitForTimeout(500);
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö–µ–ª–ø–µ—Ä–æ–≤
```typescript
import { openSidebar, openFirstAccordion, waitForRoutesLoaded } from './helpers';

// –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –≤—Å—ë —Å—Ä–∞–∑—É
await waitForRoutesLoaded(page);

// –ò–ª–∏ –ø–æ—à–∞–≥–æ–≤–æ
await openSidebar(page);
await openFirstAccordion(page);
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤ (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)

```bash
npx playwright install
```

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤

```bash
npm run test:e2e
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –≤ UI —Ä–µ–∂–∏–º–µ

```bash
npm run test:e2e:ui
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

```bash
npx playwright test e2e/routes.spec.ts
```

### –ó–∞–ø—É—Å–∫ –≤ headed —Ä–µ–∂–∏–º–µ (—Å –≤–∏–¥–∏–º—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º)

```bash
npx playwright test --headed
```

### –ó–∞–ø—É—Å–∫ –≤ debug —Ä–µ–∂–∏–º–µ

```bash
npx playwright test --debug
```

## üìä –û—Ç—á–µ—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è HTML –æ—Ç—á–µ—Ç:

```bash
npx playwright show-report
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `playwright.config.ts` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **baseURL**: `http://localhost:5173` - –±–∞–∑–æ–≤—ã–π URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **timeout**: 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç
- **retries**: 0 (–ª–æ–∫–∞–ª—å–Ω–æ), 2 (–≤ CI)
- **workers**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ), 1 (–≤ CI)
- **screenshot**: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞
- **video**: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ
- **trace**: –≤–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ

### –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞

Playwright –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç dev-—Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –µ–≥–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

## ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (app.spec.ts)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ UI

### –ú–∞—Ä—à—Ä—É—Ç—ã (routes.spec.ts)
- ‚úÖ –í—ã–±–æ—Ä –º–∞—Ä—à—Ä—É—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
- ‚úÖ –í—ã–±–æ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞ –º–∞—Ä—à—Ä—É—Ç–∞
- ‚úÖ –ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–æ–≤

### –ö–∞—Ä—Ç–∞ (map.spec.ts)
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç—ã
- ‚úÖ –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ canvas –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –º–∞—Ä—à—Ä—É—Ç–∞

### –û—Å—Ç–∞–Ω–æ–≤–∫–∏ (stations.spec.ts)
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- ‚úÖ –í—ã–±–æ—Ä –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–∑ —Å–ø–∏—Å–∫–∞
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–ø–∞–ø–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –ø—Ä–∏–±—ã—Ç–∏—è

### –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ (vehicles.spec.ts)
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –Ω–∞ canvas
- ‚úÖ –ö–ª–∏–∫ –ø–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–º—É —Å—Ä–µ–¥—Å—Ç–≤—É
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫
- ‚úÖ –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
- ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ —Ç–µ—Å—Ç–∞

```bash
npx playwright show-trace trace.zip
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞

```bash
npx playwright codegen http://localhost:5173
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

Playwright Inspector –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:

```bash
npx playwright inspector
```

## üìù –ù–∞–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

–ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ beforeEach** –¥–ª—è –æ–±—â–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
2. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –æ–∂–∏–¥–∞–Ω–∏—è** –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã** (data-testid, role, text)
4. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ edge cases** (–ø—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –æ—à–∏–±–∫–∏)
5. **–ò–∑–æ–ª–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç—ã** - –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–∞

```typescript
import { test, expect } from '@playwright/test';

test.describe('–ì—Ä—É–ø–ø–∞ —Ç–µ—Å—Ç–æ–≤', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/');
    // –û–±—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
  });

  test('–æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞', async ({ page }) => {
    // Arrange (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
    const element = page.locator('.selector');
    
    // Act (–¥–µ–π—Å—Ç–≤–∏–µ)
    await element.click();
    
    // Assert (–ø—Ä–æ–≤–µ—Ä–∫–∞)
    await expect(element).toHaveClass('active');
  });
});
```

## üîç –£–ª—É—á—à–µ–Ω–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

–î–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å data-testid –∞—Ç—Ä–∏–±—É—Ç—ã –∫ –∫–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–∞–º:

```tsx
<button data-testid="close-popup">–ó–∞–∫—Ä—ã—Ç—å</button>
```

–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ç–µ—Å—Ç–∞—Ö:

```typescript
await page.getByTestId('close-popup').click();
```

## üì¶ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ CI/CD –æ–∫—Ä—É–∂–µ–Ω–∏–∏. –í CI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
- –û–¥–∏–Ω–æ—á–Ω—ã–π worker –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- –†–µ—Ç—Ä–∞–∏ –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- Headless —Ä–µ–∂–∏–º

–ü—Ä–∏–º–µ—Ä –¥–ª—è GitHub Actions:

```yaml
- name: Install dependencies
  run: npm ci

- name: Install Playwright
  run: npx playwright install --with-deps

- name: Run E2E tests
  run: npm run test:e2e

- name: Upload test results
  if: always()
  uses: actions/upload-artifact@v3
  with:
    name: playwright-report
    path: playwright-report/
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Playwright Documentation](https://playwright.dev/)
- [Best Practices](https://playwright.dev/docs/best-practices)
- [Debugging Tests](https://playwright.dev/docs/debug)
- [CI/CD Integration](https://playwright.dev/docs/ci)
